\section{Introduction}

Structure-based drug discovery is a process of hit finding and development in target-based drug discovery. It relies on the knowledge of a three-dimensional structure of a a verified target, obtained experimentally or predicted. The structure is used for modelling of the drug-target interactions and either for a search for the novel compounds binding the target, or for optimization of previously identified binders.

Within this framework, a concept of an ultra-large library docking has emerged in the last few years. It is used for the rapid discovery of high-affinity hit compounds, without iterative optimizations of initial hits. In this approach, an ultra-large (typically, tens of millions of compounds) library is screened against a known target via structure-based docking. Molecules with the lowest docking score undergo subsequent filtering, and selected compounds (few hundreds) are tested experimentally \cite{bender_practical_2021}. Most studies involve using virtual libraries, such as Enamine REAL \cite{noauthor_real_nodate}. Their design ensures high synthesizability rate, thereby providing a sufficiently large number of physically available compounds regardless of the target.

Recently, ultra-large library docking has been shown to provide high-affinity hit compounds for various targets \cite{sigma2_paper, melatonin_paper, ultralarge_docking_first, gorgulla_open-source_2020, beroza_chemical_2022, noauthor_large_nodate, lu_structure-guided_2021, sadybekov_synthon-based_2022, sadybekov_structure-based_2020} after experimental testing of only few hundreds of compounds. However, such approach requires substantial computational resources: namely, docking of single compound requires few CPU-seconds, yielding tens of CPU-years for the whole library, which in turn equals tens of thousands dollars of computational costs at cloud services such as Google Cloud or Amazon Web Services \cite{irwin_large_2023,grebner_virtual_2020}.

Few approaches to reduce computational requirements have been proposed recently. Firstly, multiple groups have applied active learning for iterative selection of compounds subjected to docking \cite{Graff2021AcceleratingLearning,autoencoders_guided_learning,logistic_regression,deepdocking,leandocking,Yang2021_shoichet_active_learning}. The active learning loops are based on prediction of docking scores from binary fingerprints of compounds. Prediction of scores is performed using either deep learning approaches \cite{deepdocking,Yang2021_shoichet_active_learning,autoencoders_guided_learning, Graff2021AcceleratingLearning} or simpler linear models \cite{leandocking,logistic_regression}. Moreover, de Graaf et al explored classic recommender system approaches for within active learning framework \cite{Graff2021AcceleratingLearning}. 

Most of these approaches report multiple reduction of the computational costs for the docking itself: Gentile et al report up to 100-fold data reduction, de Graaf et al report finding of 95\% of the top-50\ 000 of the library after screening only 2.5\% of it, confirmed by Martin \cite{logistic_regression} in the later study. Finally, Yang et al \cite{Yang2021_shoichet_active_learning} recently reported finding more than 80\% of the experimentally confirmed hits with a 14-fold reduction in compute cost.

Finally, most recent approaches \cite{Sadybekov2021_vsynthes,beroza_chemical_2022} rely on the inner structure of ultra-large libraries to substantially reduce the computational requirements in fragment-based manner. Briefly, the building blocks of the ultra-large library are first ranked by their docking score to the target receptor. Then, only compounds that can be synthesized from high-ranked building blocks, are subjected to docking. This has led to rapid hit finding for such targets as ROCK1 kinase and human cannabinoid receptors 1 and 2 with docking less than 1\% of the whole library.

% Other approaches to accelerate different screening processes have been also proposed, including ... and .... Moreover, generative molecule design have been proposed as a fundamentally different approach for rapid hit finding, as reviewed in ...

% Other approaches in this area explored genetic algorithms for acceleration of virtual screening \cite{Jensen2019,Ree2021}, as well as for multi-objective optimization \cite{Steinmann2021}. 


In this work, we further explore the active learning approach to accelerate ultra-large structure-based virtual screening. We generate synthetic datasets of docking scores of 1 million molecules from ZINC20 \cite{Irwin2020ZINC20Discovery} for two targets, human adenosine receptor A2 (AA2AR) and human cannabinoid receptor 2 (CB2) using Molsoft ICM. We also use existing open-access docking score datasets from recent studies \cite{ultralarge_docking_first}. 

Using these four datasets of docking scores, we benchmark classical machine learning algorithms in their ability to predict a docking score from molecular fingerprints. In each dataset, we label 1\% of the highest scored ligands as virtual screening hits (VSHs), and test different algorithms in their ability to retrieve VSHs from the whole library after training on a subset of ligands.

We first benchmark the algorithms in a non-iterative, or single-shot, docking score prediction task, and compare their ability to retrieve VSHs from a large library. We then choose a linear regression as a base model for the iterative ligand retrieval. In the iterative regime, after docking a small batch of ligands, a base model is trained on the retrieved scores, and the next molecules for docking are chosen based on the predicted docking scores.

To confirm our choice of the linear regression as a base model, we test our ability to extrapolate single-shot prediction performance to the active learning regime. After that, we compare multiple active learning regime parameters, such as batch size and growth of the training size between iterations. Moreover, we compare different mechanisms for memory of the active learning model: namely, approaches to ensemble models, trained during different iteration steps.

We show that simplest models such as linear regression, with training and inference time under 1 munite, perform as well as much more complex regression models such as random forest regression, with few hours of inference time. We conclude that active learning regime benefits from as small batch size as $10\ 000$ molecules. For the active learning, we find that models with a simple memory mechanism confidently outperform other models. We also find that memory-less active learning regime provides comparable results for the screening, paving the way towards the design of the active learning models design with low computational costs. With simple linear models, we report discovery 50-90\% of top-1\% of the virtual hits, depending on target, after screening only 10\% of the 1 million library.
 
Overall, we believe that our findings confirm that simple models are as efficient as the previously used deep-learning based models for predicting the intrinsically inaccurate results of the structure-based molecular docking. We hope that our findings will guide designs of computationally effective accelerated docking pipelines, and facilitate rapid drug discovery campaigns using structure-based drug design.
